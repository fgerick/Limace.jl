<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Torsional Alfvén modes · Limace.jl</title><meta name="title" content="Torsional Alfvén modes · Limace.jl"/><meta property="og:title" content="Torsional Alfvén modes · Limace.jl"/><meta property="twitter:title" content="Torsional Alfvén modes · Limace.jl"/><meta name="description" content="Documentation for Limace.jl."/><meta property="og:description" content="Documentation for Limace.jl."/><meta property="twitter:description" content="Documentation for Limace.jl."/><meta property="og:url" content="https://fgerick.github.io/Limace.jl/examples/torsionalmodes/"/><meta property="twitter:url" content="https://fgerick.github.io/Limace.jl/examples/torsionalmodes/"/><link rel="canonical" href="https://fgerick.github.io/Limace.jl/examples/torsionalmodes/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Limace.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../inertialmodes/">Inviscid inertial modes</a></li><li class="is-active"><a class="tocitem" href>Torsional Alfvén modes</a><ul class="internal"><li><a class="tocitem" href="#Assembly"><span>Assembly</span></a></li><li><a class="tocitem" href="#Solve-the-eigen-problem"><span>Solve the eigen problem</span></a></li><li><a class="tocitem" href="#Plot-the-solution"><span>Plot the solution</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../bases/">Bases</a></li><li><a class="tocitem" href="../../forces/">Forces</a></li><li><a class="tocitem" href="../../poly/">Poly</a></li><li><a class="tocitem" href="../../processing/">Postprocessing</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Torsional Alfvén modes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Torsional Alfvén modes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fgerick/Limace.jl/blob/main/examples/torsionalmodes.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Torsional-Alfvén-modes"><a class="docs-heading-anchor" href="#Torsional-Alfvén-modes">Torsional Alfvén modes</a><a id="Torsional-Alfvén-modes-1"></a><a class="docs-heading-anchor-permalink" href="#Torsional-Alfvén-modes" title="Permalink"></a></h1><p>Torsional Alfvén modes exist when a conducting fluid is under rapid rotation, so that the rotation time <span>$t_\Omega$</span> is much shorter than the Alfvén time <span>$t_A=L\sqrt{\mu_0\rho}/B_0$</span>. Put differently, the Lehnert number <span>$\mathrm{Le}= t_\Omega/t_A \ll 1$</span>. Then, the flow is dominated by a geostrophic balance at the leading order, and slight departures from the geostrophic balance are restored through the Lorentz force. The result are torsional Alfvén modes (or waves), that are in essence differentially rotating geostrophic cylinders, that stretch the cylindrical radial magnetic field lines that permeate them.</p><p>A one-dimensional equation can be derived in the diffusionless limit (<a href="../../references/#braginsky_torsional_1970">Braginsky, 1970</a>). Using Limace.jl, we can instead compute weakly diffusive torsional Alfvén modes as solutions to a two-dimensional problem, when the background magnetic field is axisymmetric. In this case, all azimuthal wavenumbers <span>$m$</span> decouple and we can focus on <span>$m=0$</span>.</p><p>In the following example we will solve and illustrate the gravest torsional mode, for an axisymmetric poloidal background magnetic field.</p><pre><code class="language-julia hljs">using Limace, SparseArrays, CairoMakie
using Limace.EigenProblem: eigstarget
using Limace.Discretization: spectospat</code></pre><h2 id="Assembly"><a class="docs-heading-anchor" href="#Assembly">Assembly</a><a id="Assembly-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly" title="Permalink"></a></h2><p>We can assemble the submatrices and concatenate them to get our final left hand side matrix <code>LHS</code> and right hand side matrix <code>RHS</code>.</p><p>Here, the non-dimensional parameters are the Lehnert number <code>Le</code> and the Lundquist number <code>Lu</code>. We give the resolution by an integer <code>N</code>, that determines the polynomial degree of our solutions. This function takes for <code>B0</code> a collection of <code>BasisElement</code>&#39;s, as shown below.</p><pre><code class="language-julia hljs">function assemble(N, Le, Lu, B0)
	u = Inviscid(N; m=0)
	b = Insulating(N; m=0)
	LHS = blockdiag(sparse(Limace.inertial(u),length(u),length(u)), sparse(Limace.inertial(b)))
	RHSc = Limace.coriolis(u)/Le
	RHSl = sum(Limace.lorentz_threaded(u,b,B) for B in B0)
	RHSi = sum(Limace.induction_threaded(b,u,B) for B in B0)
	RHSd = Limace.diffusion(b)/Lu
	RHS = [RHSc RHSl
		   RHSi RHSd]
	return LHS, RHS, u, b
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">assemble (generic function with 1 method)</code></pre><p>Define parameters and background magnetic field:</p><pre><code class="language-julia hljs">N = 100
Le = 5e-4
Lu = 1/Le
B0 = [BasisElement(Basis{Insulating}, Poloidal, (1,0,1),0.3), BasisElement(Basis{Insulating}, Poloidal, (2,0,1),0.7)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{BasisElement{Basis{Insulating}, Poloidal, Float64}}:
 BasisElement{Basis{Insulating}, Poloidal, Float64}((1, 0, 1), 0.3)
 BasisElement{Basis{Insulating}, Poloidal, Float64}((2, 0, 1), 0.7)</code></pre><p>This background field is a mix of two poloidal field components, <code>l,m,n=(1,0,1)</code> and <code>l,m,n = (2,0,1)</code>, i.e. dipolar and quadrupolar symmetry.</p><p>Assemble the matrices:</p><pre><code class="language-julia hljs">LHS, RHS, u, b = assemble(N, Le, Lu, B0);</code></pre><h2 id="Solve-the-eigen-problem"><a class="docs-heading-anchor" href="#Solve-the-eigen-problem">Solve the eigen problem</a><a id="Solve-the-eigen-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-the-eigen-problem" title="Permalink"></a></h2><p>We can calculate some eigenvalues and vectors near a given <code>target</code>. For torsional modes it is sensible to choose a target near <code>λ = -σ+im*ω = 1.0im</code>, i.e. an Alfvén frequency of 1 (note: this only the case, when using the Alfvén time as the characteristic time-scale in the nondimensionalization).</p><pre><code class="language-julia hljs">target = 1.0im</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0 + 1.0im</code></pre><p><code>Limace.jl</code> provides the <code>eigstarget</code> function, based on shift-invert spectral transform and an implicitly restarted Arnoldi method. The keyword <code>nev</code> can be set to the desired number of eigenvalues.</p><pre><code class="language-julia hljs">λ, x = eigstarget(RHS, LHS, target; nev=5);</code></pre><h2 id="Plot-the-solution"><a class="docs-heading-anchor" href="#Plot-the-solution">Plot the solution</a><a id="Plot-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-solution" title="Permalink"></a></h2><p>We find the solution of largest real part, corresponding to the smallest damping rate. In this simple example this is enough to isolate the gravest torsional mode from the other calculated solutions.</p><pre><code class="language-julia hljs">per = sortperm(λ, by = real, rev=true);

λ[per]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{ComplexF64}:
 -0.030069600041294647 + 0.9335345787536469im
  -0.10584348423190662 + 1.1314854818324247im
  -0.20073267188133254 + 1.4023873416517345im
   -0.2979605642852868 + 1.7459285394571809im
    -0.748072471564561 + 1.58653523644282im</code></pre><p>We discretize the corresponding eigenvector in the meridional plane. Since <span>$m=0$</span>, we do not need more than one value of the longitude.</p><pre><code class="language-julia hljs">nr, nθ, nϕ = 2N+1, 2N+1, 1

ur,uθ,uϕ, br,bθ,bϕ, r,θ,ϕ = spectospat(x[:,per[1]], u,b, nr,nθ,nϕ);</code></pre><p>The meridional slices are plotted with <code>CairoMakie.jl</code> for example:</p><pre><code class="language-julia hljs">let
	f = Figure()
	for (i,(comp, title)) in enumerate(zip((ur, uθ, uϕ),(L&quot;u_r&quot;, L&quot;u_\theta&quot;, L&quot;u_\phi&quot;)))
		ax = Axis(f[1,2i]; aspect=DataAspect(), title)
		hidedecorations!(ax)
		hidespines!(ax)
		x = r .* cos.(θ&#39;)
		y = r .* sin.(θ&#39;)
		z = real.(comp[:,:,1])
		clim = maximum(abs,z)
		cax = surface!(ax, x,y, z, colormap=:vik, colorrange=(-clim,clim),shading=NoShading)
		Colorbar(f[1,2i-1],cax, flipaxis=false)
	end
	for (i,(comp, title)) in enumerate(zip((br,bθ,bϕ),(L&quot;b_r&quot;, L&quot;b_\theta&quot;, L&quot;b_\phi&quot;)))
		ax = Axis(f[2,2i]; aspect=DataAspect(), title)
		hidedecorations!(ax)
		hidespines!(ax)
		x = r .* cos.(θ&#39;)
		y = r .* sin.(θ&#39;)
		z = real.(comp[:,:,1])
		clim = maximum(abs,z)
		cax = surface!(ax, x,y, z, colormap=:broc, colorrange=(-clim,clim),shading=NoShading)
		Colorbar(f[2,2i-1],cax, flipaxis=false)
	end

	f
end</code></pre><img src="b6c7f319.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inertialmodes/">« Inviscid inertial modes</a><a class="docs-footer-nextpage" href="../../bases/">Bases »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 2 October 2024 22:16">Wednesday 2 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
