<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theoretical background · Limace.jl</title><meta name="title" content="Theoretical background · Limace.jl"/><meta property="og:title" content="Theoretical background · Limace.jl"/><meta property="twitter:title" content="Theoretical background · Limace.jl"/><meta name="description" content="Documentation for Limace.jl."/><meta property="og:description" content="Documentation for Limace.jl."/><meta property="twitter:description" content="Documentation for Limace.jl."/><meta property="og:url" content="https://fgerick.github.io/Limace.jl/theory/"/><meta property="twitter:url" content="https://fgerick.github.io/Limace.jl/theory/"/><link rel="canonical" href="https://fgerick.github.io/Limace.jl/theory/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Limace.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Theoretical background</a><ul class="internal"><li><a class="tocitem" href="#Galerkin-projection"><span>Galerkin projection</span></a></li><li><a class="tocitem" href="#Poloidal-and-toroidal-basis-vectors"><span>Poloidal and toroidal basis vectors</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/inertialmodes/">Inviscid inertial modes</a></li><li><a class="tocitem" href="../examples/torsionalmodes/">Torsional Alfvén modes</a></li></ul></li><li><a class="tocitem" href="../bases/">Bases</a></li><li><a class="tocitem" href="../forces/">Forces</a></li><li><a class="tocitem" href="../poly/">Poly</a></li><li><a class="tocitem" href="../processing/">Postprocessing</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theoretical background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theoretical background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fgerick/Limace.jl/blob/main/docs/src/theory.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Theoretical-background"><a class="docs-heading-anchor" href="#Theoretical-background">Theoretical background</a><a id="Theoretical-background-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-background" title="Permalink"></a></h1><p><code>Limace.jl</code> uses a Galerkin projection method to discretize a linearized version of the non-linear rotating magnetohydrodynamic (MHD) equations, following works of <a href="../references/#bullard_homogeneous_1954">Bullard and Gellman (1954)</a>, <a href="../references/#ivers_scalar_2008">Ivers and Phillips (2008)</a> and <a href="../references/#gerick_interannual_2024">Gerick and Livermore (2024)</a>. For a very detailed account of all steps, the interested reader is referred to <a href="../references/#gerick_interannual_2024">Gerick and Livermore (2024)</a>. Here, a quick and simplified overview of the mathematical and physical tools used in the model is given.</p><p>In non-linear form, the momentum equations of the incompressible fluid and the induction equation, are written as</p><p class="math-container">\[\begin{align}
	\frac{\partial \mathbf{U}}{\partial t} + \left(\boldsymbol{\nabla}\times\mathbf{U}\right)\times\mathbf{U} + 2\boldsymbol{\Omega}\times\mathbf{U} &amp;= -\frac{1}{\rho}\nabla P + \frac{1}{\rho\mu_0} \left(\boldsymbol{\nabla}\times\mathbf{B}\right)\times\mathbf{B} + \nu\boldsymbol{\nabla}^2\mathbf{U} + \mathbf{F}, \\
	\frac{\partial \mathbf{B}}{\partial t} &amp;= \boldsymbol{\nabla}\times\left(\mathbf{U}\times\mathbf{B}\right) + \eta \boldsymbol{\nabla}^2\mathbf{B},
\end{align}\]</p><p>with <span>$\mathbf{U}$</span> the velocity, <span>$\mathbf{B}$</span> the magnetic field, <span>$\boldsymbol{\Omega}$</span> the rotation axis, <span>$\rho$</span> the fluid density, <span>$P$</span> the reduced hydrodynamic pressure, <span>$\mu_0$</span> the magnetic permeability of free space, <span>$\nu$</span> the kinematic viscosity, <span>$\mathbf{F}$</span> some additional body force, and <span>$\eta$</span> the magnetic diffusivitiy.</p><p>The velocity, magnetic and pressure fields a linearized, so that </p><p class="math-container">\[\begin{align}
	\mathbf{U}(\mathbf{r},t) &amp; = \mathbf{U}_0(\mathbf{r})+ \mathbf{u}(\mathbf{r}) e^{\lambda t}, \\
	\mathbf{B}(\mathbf{r},t) &amp; = \mathbf{B}_0(\mathbf{r})+ \mathbf{b}(\mathbf{r}) e^{\lambda t}, \\
	P(\mathbf{r},t)   &amp; = P_0(\mathbf{r})+ p(\mathbf{r}) e^{\lambda t}.
\end{align}\]</p><p>with <span>$\lambda=-\sigma+\mathrm{i}\omega$</span>, with <span>$\sigma$</span> the damping rate and <span>$\omega$</span> the frequency of the oscillatory perturbation to the steady background. Removing the steady part and neglecting higher order terms, the linearized MHD equations read</p><p class="math-container">\[\begin{align}
	\lambda\mathbf{u} =&amp; -\left(\boldsymbol{\nabla}\times\mathbf{u}\right)\times\mathbf{U}_0- \left(\boldsymbol{\nabla}\times\mathbf{U}_0\right)\times\mathbf{u} -2\Omega\mathbf{e}_z\times\mathbf{u} - \frac{1}{\rho}\nabla p\\
	 &amp;+ \frac{1}{\rho\mu_0}\left(\left(\boldsymbol{\nabla}\times\mathbf{b}\right)\times\mathbf{B}_0+\left(\boldsymbol{\nabla}\times\mathbf{B}_0\right)\times\mathbf{b}\right) + \nu \boldsymbol{\nabla}^2\mathbf{u},\nonumber\\
	\lambda\mathbf{b} =&amp; \boldsymbol{\nabla}\times\left(\mathbf{U}_0\times\mathbf{b}\right) + \boldsymbol{\nabla}\times\left(\mathbf{u}\times\mathbf{B}_0\right) + \eta \boldsymbol{\nabla}^2\mathbf{b}.
\end{align}\]</p><h2 id="Galerkin-projection"><a class="docs-heading-anchor" href="#Galerkin-projection">Galerkin projection</a><a id="Galerkin-projection-1"></a><a class="docs-heading-anchor-permalink" href="#Galerkin-projection" title="Permalink"></a></h2><p>The linearized equations are projected onto trial vectors <span>$\boldsymbol{\xi}_i$</span>, so that</p><p class="math-container">\[f_{ij} = \int \boldsymbol{\xi}_i \cdot \mathbf{f}\left(\mathbf{u}_j,\mathbf{b}_j, \mathbf{U}_0, \mathbf{B}_0\right)\,\mathrm{d}V,\]</p><p>where <span>$\mathbf{f}$</span> is any of the terms in the considered MHD equations and <span>$\boldsymbol{\xi}_i = [\mathbf{u}_i, \mathbf{b}_i]$</span>.</p><h2 id="Poloidal-and-toroidal-basis-vectors"><a class="docs-heading-anchor" href="#Poloidal-and-toroidal-basis-vectors">Poloidal and toroidal basis vectors</a><a id="Poloidal-and-toroidal-basis-vectors-1"></a><a class="docs-heading-anchor-permalink" href="#Poloidal-and-toroidal-basis-vectors" title="Permalink"></a></h2><p>Due to the divergence free condition on the velocity and magnetic field, i.e. the flow is incompressible and no magnetic monopoles,  it is convenient to decompose the fields into poloidal and toroidal components.</p><p class="math-container">\[\begin{align}
    \mathbf{u} &amp;= \sum_i \alpha_i\mathbf{u}_i = \sum_{l,m,n} \alpha^P_{lmn}\mathbf{P}_{lmn} + \sum_{l,m,n} \alpha^Q_{lmn}\mathbf{Q}_{lmn},\\
    \mathbf{b} &amp;= \sum_i \beta_i\mathbf{b}_i =  \sum_{l,m,n} \beta^S_{lmn}\mathbf{S}_{lmn} + \sum_{l,m,n} \beta^T_{lmn}\mathbf{T}_{lmn},
\end{align}\]</p><p>with the respective poloidal and toroidal basis vectors</p><p class="math-container">\[\begin{align}
	\left[\mathbf{P},\mathbf{S}\right]_{lmn} &amp; = \boldsymbol{\nabla}\times\boldsymbol{\nabla}\times \left[P,S\right]_{ln}(r)Y_l^m(\theta,\phi)\mathbf{r}, \\
	\left[\mathbf{Q},\mathbf{T}\right]_{lmn} &amp; = \boldsymbol{\nabla}\times \left[Q,T\right]_{ln}(r) Y_l^m(\theta,\phi)\mathbf{r}.
\end{align}\]</p><p>Here, <span>$Y_l^m$</span> is the (fully normalized) spherical harmonic of degree <span>$l$</span> and order <span>$m$</span>.</p><p>We therefore need to consider all combinations of poloidal and toroidal vector combinations in the projection of the forces. This leads to several long coupling terms, especially for the Lorentz force and induction term.  The integrals of these coupling terms over the spherical sourfaces can be reduced to Adam-Gaunt and Elsasser integrals, and it remains to calculate the radial integral. The detailed equations implemented in <code>Limace.jl</code> are given in <a href="../references/#gerick_interannual_2024">Gerick and Livermore (2024)</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../examples/inertialmodes/">Inviscid inertial modes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 1 October 2024 14:45">Tuesday 1 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
